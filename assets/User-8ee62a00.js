import{aX as f,b as V,c as k,o as _,e as E,f as w,g as l,w as a,h as e,aw as X,F as B,ax as Y,j as c,t as p,N as C,U as Z,Y as z,a3 as G,A as $,E as J,k as K,Z as Q,$ as ee}from"./index-85da6439.js";import{E as te}from"./el-dialog-378dcb09.js";import{E as oe,a as le}from"./el-form-item-9d327681.js";import{u as ae}from"./use-table-handlers-9f4dc289.js";const se=s=>f({url:"sys/user/listPage",method:"get",data:s}),ne=s=>f({url:"sys/user/save",method:"post",data:s}),re=s=>{const{id:d}=s;return delete s.id,f({url:`sys/user/update/${d}`,method:"post",data:s})},de=s=>{const{id:d}=s;return delete s.id,f({url:`sys/user/password/${d}`,method:"get",data:s})},ie=s=>f({url:"sys/user/delete",method:"post",data:s}),me={class:"main-body"},ue={class:"toolbar"},ge={__name:"User",setup(s){const d=V({username:""}),i=V({id:"",name:"",roleId:""}),{t,tableRef:v,dialogVisible:h,isEdit:g,formLoading:I,formRef:R,doSearch:x,doAdd:U,doEdit:ce,doSubmit:D,doClose:N,doRemove:S}=ae(i),W=k(()=>[{type:"selection",selectable:T},{prop:"id",label:t("thead.ID"),minWidth:50},{prop:"name",label:t("thead.username"),minWidth:120},{prop:"roleName",label:t("thead.group"),minWidth:120},{prop:"createdBy",label:t("thead.createdBy"),minWidth:120},{prop:"ip",label:t("thead.latestIp"),minWidth:100},{prop:"visitTime",label:t("thead.latestVisit"),minWidth:120}]),H=k(()=>({name:[{required:!0,message:t("form.usernameHolder"),trigger:["blur","change"]}],roleId:[{required:!0,message:t("form.roleRequired"),trigger:["blur","change"]}]})),P=[{type:"edit",show:o=>o.createdBy!=="system"},{type:"delete",show:o=>o.createdBy!=="system"}];function T(o){return o.createdBy!=="system"}function q(o,r){S(ie,o,r)}function F(){D({save:ne,update:re},o=>{g.value||$.alert(`${t("tips.success")}${t("form.username")}: ${o.data.name},${t("form.password")}: ${o.data.password}`,t("tips.title"),{confirmButtonText:t("action.confirm")})})}function A(){de({...i}).then(o=>{$.alert(`${t("tips.success")}${t("form.username")}: ${o.data.name},${t("form.password")}: ${o.data.password}`,t("tips.title"),{confirmButtonText:t("action.confirm")})})}return(o,r)=>{const y=J,m=le,u=K,b=oe,L=Y,j=Q,M=ee,O=te;return _(),E(B,null,[w("div",me,[w("div",ue,[l(b,{inline:!0,model:e(d)},{default:a(()=>[l(m,null,{default:a(()=>[l(y,{modelValue:e(d).name,"onUpdate:modelValue":r[0]||(r[0]=n=>e(d).name=n),placeholder:e(t)("thead.username")},null,8,["modelValue","placeholder"])]),_:1}),l(m,null,{default:a(()=>[l(u,{icon:"search",onClick:e(x),type:"primary"},{default:a(()=>[c(p(e(t)("action.search")),1)]),_:1},8,["onClick"])]),_:1}),l(m,null,{default:a(()=>[l(u,{icon:"plus",onClick:e(U),type:"primary"},{default:a(()=>[c(p(e(t)("action.add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),l(L,{ref_key:"tableRef",ref:v,"get-page":e(se),filters:e(d),columns:e(W),operations:P,onHandleEdit:o.handleEdit,onHandleDelete:q},null,8,["get-page","filters","columns","onHandleEdit"])]),l(O,{title:e(g)?e(t)("action.edit"):e(t)("action.add"),modelValue:e(h),"onUpdate:modelValue":r[3]||(r[3]=n=>X(h)?h.value=n:null),draggable:"true",width:"40%","close-on-click-modal":!1,onClose:o.closeDlg},{footer:a(()=>[l(u,{type:"primary",onClick:e(N)},{default:a(()=>[c(p(e(t)("action.cancel")),1)]),_:1},8,["onClick"]),e(g)?(_(),C(u,{key:0,type:"primary",onClick:A},{default:a(()=>[c(p(e(t)("form.resetPassword")),1)]),_:1})):Z("",!0),l(u,{type:"primary",onClick:F,loading:e(I)},{default:a(()=>[c(p(e(t)("action.submit")),1)]),_:1},8,["loading"])]),default:a(()=>[l(b,{ref_key:"formRef",ref:R,model:e(i),rules:e(H),"label-width":"80px","label-position":"right"},{default:a(()=>[l(m,{label:e(t)("form.username"),prop:"name"},{default:a(()=>[l(y,{modelValue:e(i).name,"onUpdate:modelValue":r[1]||(r[1]=n=>e(i).name=n),placeholder:e(t)("form.enterUsername")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(m,{label:e(t)("form.group"),prop:"roleId"},{default:a(()=>[l(M,{modelValue:e(i).roleId,"onUpdate:modelValue":r[2]||(r[2]=n=>e(i).roleId=n),placeholder:e(t)("form.choose"),style:{width:"100%"}},{default:a(()=>[(_(!0),E(B,null,z(e(G),n=>(_(),C(j,{key:n.name,label:n.label,value:n.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])],64)}}};export{ge as default};
